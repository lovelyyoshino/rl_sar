# Copyright (c) 2024-2025 Ziqi Fan
# SPDX-License-Identifier: Apache-2.0

# Policy config aligned to robot_lab:
# - Env: locomotion/velocity (rough), UnitreeG1RoughEnvCfg
# - Obs terms enabled in rough_env_cfg.py:
#   base_ang_vel, projected_gravity, velocity_commands, joint_pos_rel, joint_vel_rel, last_action
# - Action: JointPositionActionCfg(scale=0.25, use_default_offset=True)

g1_23/robomimic/locomotion:
  model_name: "policy_23dof.pt"

  # Observations order must match training.
  observations: ["ang_vel", "gravity_vec", "commands", "dof_pos", "dof_vel", "actions"]
  observations_history: []
  observations_history_priority: "time"

  num_of_dofs: 23
  num_observations: 78  # 3 + 3 + 3 + 23 + 23 + 23

  clip_obs: 100.0
  clip_actions_lower: [-100.0, -100.0, -100.0, -100.0, -100.0, -100.0,
                       -100.0, -100.0, -100.0, -100.0, -100.0, -100.0,
                       -100.0,
                       -100.0, -100.0, -100.0, -100.0, -100.0,
                       -100.0, -100.0, -100.0, -100.0, -100.0]
  clip_actions_upper: [ 100.0,  100.0,  100.0,  100.0,  100.0,  100.0,
                        100.0,  100.0,  100.0,  100.0,  100.0,  100.0,
                        100.0,
                        100.0,  100.0,  100.0,  100.0,  100.0,
                        100.0,  100.0,  100.0,  100.0,  100.0]

  # PD gains aligned to IsaacLab Unitree G1 actuators (isaaclab_assets/robots/unitree.py).
  # Order follows policy/g1_23/base.yaml joint_names (training order).
  rl_kp: [200.0, 150.0, 150.0, 200.0,  20.0,  20.0,
          200.0, 150.0, 150.0, 200.0,  20.0,  20.0,
          200.0,
           40.0,  40.0,  40.0,  40.0,  40.0,
           40.0,  40.0,  40.0,  40.0,  40.0]
  rl_kd: [ 5.0,  5.0,  5.0,  5.0,  2.0,  2.0,
           5.0,  5.0,  5.0,  5.0,  2.0,  2.0,
           5.0,
          10.0, 10.0, 10.0, 10.0, 10.0,
          10.0, 10.0, 10.0, 10.0, 10.0]

  # Fixed gains used by getup/getdown transitions.
  fixed_kp: [200.0, 150.0, 150.0, 200.0,  20.0,  20.0,
             200.0, 150.0, 150.0, 200.0,  20.0,  20.0,
             200.0,
              40.0,  40.0,  40.0,  40.0,  40.0,
              40.0,  40.0,  40.0,  40.0,  40.0]
  fixed_kd: [ 5.0,  5.0,  5.0,  5.0,  2.0,  2.0,
              5.0,  5.0,  5.0,  5.0,  2.0,  2.0,
              5.0,
             10.0, 10.0, 10.0, 10.0, 10.0,
             10.0, 10.0, 10.0, 10.0, 10.0]

  action_scale: [0.25, 0.25, 0.25, 0.25, 0.25, 0.25,
                 0.25, 0.25, 0.25, 0.25, 0.25, 0.25,
                 0.25,
                 0.25, 0.25, 0.25, 0.25, 0.25,
                 0.25, 0.25, 0.25, 0.25, 0.25]
  wheel_indices: []

  # Scales aligned to robot_lab rough_env_cfg.py
  lin_vel_scale: 1.0
  ang_vel_scale: 0.25
  dof_pos_scale: 1.0
  dof_vel_scale: 0.05
  commands_scale: [1.0, 1.0, 1.0]

  # Default pose MUST match the pose used for joint_pos_rel in training (IsaacLab init_state.joint_pos).
  default_dof_pos: [-0.20, 0.0, 0.0, 0.42, -0.23, 0.0,
                    -0.20, 0.0, 0.0, 0.42, -0.23, 0.0,
                     0.0,
                     0.35, 0.16, 0.0, 0.87, 0.0,
                     0.35, -0.16, 0.0, 0.87, 0.0]

  # Effort limits aligned to IsaacLab effort_limit_sim (feet are 20, others 300).
  torque_limits: [300.0, 300.0, 300.0, 300.0,  20.0,  20.0,
                  300.0, 300.0, 300.0, 300.0,  20.0,  20.0,
                  300.0,
                  300.0, 300.0, 300.0, 300.0, 300.0,
                  300.0, 300.0, 300.0, 300.0, 300.0]

  # Training-order joints already used in base.yaml -> identity mapping.
  joint_mapping: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]

